<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: DataContext.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: DataContext.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useState, useContext, createContext, useEffect } from "react";
import firebase from "firebase";
import "firebase/firestore";

/** 
 * Контекст приложения
 * @component
 * @property {Object} messagesInit - Исходное состояние для массива сообщений
 * @property {Array} messages - Массив сообщений
 * @property {Function} setMessages - Функция изменения состояния messages
 * @property {Object} fieldsInit - Исходные данные полей формы
 * @property {Object} fields - Поля формы
 * @property {Function} setFormData - Функция изменения состояния fields
*/

const DataContext = createContext();

/** Initialize Firebase */
firebase.initializeApp({
	apiKey: "AIzaSyCtqtrFD2dPydMhzOsPYA7kGVh4c4pHlVM",
	authDomain: "react-chat-3fddd.firebaseapp.com",
	databaseURL:
		"https://react-chat-3fddd-default-rtdb.europe-west1.firebasedatabase.app",
	projectId: "react-chat-3fddd",
	storageBucket: "react-chat-3fddd.appspot.com",
	messagingSenderId: "724657066180",
	appId: "1:724657066180:web:ed7f2f996044d2be4ab991",
});

export const DataProvider = ({ children }) => {
	/** Создание БД */
	const firestore = firebase.database();

	/** 
	 * Исходное состояние массива сообщений
	 */
	const messagesInit = [
		{
			id: 1,
			author: "Anonymous",
			text:
				"Lorem ipsum dolor sit amet consectetur adipisicing elit. Ipsam est asperiores possimus nobis explicabo ipsum aliquid, blanditiis obcaecati commodi hic, distinctio mollitia iure. Voluptate illum odio repellendus aperiam quis voluptatem.",
		},
	];

	/** 
	 * Объявление переменной состояния сообщений
	*/
	const [messages, setMessages] = useState([]);

	/**
	 * При первом рендере обращаемся к БД и добавляем в state messages
	 */
	useEffect(() => {
		let messagesRef = firebase.database().ref('messages');
		messagesRef.on('value', (snapshot) => {
			const messages = snapshot.val();
			const messagesList = []

			for (let id in messages) {
				messagesList.push(messages[id]);
			}

			setMessages(messagesList);
		})
	}, []);

	/** 
	 * Исходное состояние полей формы
	*/
	const fieldsInit = {
		id: 1,
		author: "Anonymous",
		text: "",
	};

	/** 
	 * Объявление переменной состояния полей формы
	 */
	const [fields, setFormData] = useState(fieldsInit);

	return (
		&lt;DataContext.Provider
			value={{
				messagesInit,
				messages,
				fieldsInit,
				fields,
				setFormData,
				firebase,
				firestore,
			}}
		>
			{children}
		&lt;/DataContext.Provider>
	);
};

export const useData = () => useContext(DataContext);
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="App.html">App</a></li><li><a href="DataContext.html">DataContext</a></li><li><a href="Form.html">Form</a></li><li><a href="Message.html">Message</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Fri Jul 02 2021 03:13:35 GMT+0300 (Москва, стандартное время)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
